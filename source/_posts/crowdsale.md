

### ä¸ºä½ çš„ideaä¼—ç­¹

æœ‰æ—¶å€™ä¸€ä¸ªå¥½çš„æƒ³æ³•éœ€è¦å¤§é‡çš„èµ„é‡‘å’Œé›†ä½“çš„åŠªåŠ›ã€‚ä½ å¯èƒ½ä¼šéœ€è¦æèµ ï¼Œ ä½†æ˜¯æèµ è€…æ›´å€¾å‘äºç»™äºˆé¡¹ç›®ä»–ä»¬æ›´ç¡®å®šçš„æ˜¯è·å¾—åŠ¨åŠ›å’Œé€‚å½“çš„èµ„é‡‘ã€‚è¿™æ˜¯ä¸€ä¸ªä¼—ç­¹å¾ˆç†æƒ³çš„ä¾‹å­: ä½ è®¾ç½®ä¸€ä¸ªç›®æ ‡å’Œhæˆªæ­¢æ—¥æœŸã€‚å¦‚æœä½ æ²¡æœ‰å®ç°è¿™ä¸ªç›®æ ‡ï¼Œæèµ ä¼šè¿”è¿˜ï¼Œä»¥æ­¤æ¥å‡å°‘æèµ è€…çš„é£é™©ã€‚ å› ä¸ºä»£ç æ˜¯å…¬å¼€å¯å®¡è®¡çš„ï¼Œæ²¡æœ‰å¿…è¦é›†ä¸­æ§åˆ¶ï¼Œ å€¼å¾—ä¿¡èµ–çš„å¹³å°å› æ­¤ï¼Œæ¯ä¸ªäººéƒ½è¦æ”¯ä»˜çš„å”¯ä¸€è´¹ç”¨å°±æ˜¯gasã€‚

#### Tokens and DAOs

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡è§£å†³ä¸¤ä¸ªé‡è¦é—®é¢˜æ¥è¿›è¡Œæ›´å¥½çš„ä¼—ç­¹: å¦‚ä½•ç®¡ç†å’Œä¿æŒå›æŠ¥, ä»¥åŠè¿™äº›é’±æ˜¯å¦‚ä½•åœ¨ç­¹é›†åˆ°èµ„é‡‘ä¹‹åè¢«èŠ±æ‰çš„ã€‚
ä¼—ç­¹çš„å›æŠ¥é€šå¸¸ç”±ä¸€ä¸ªæ— æ³•æ”¹å˜çš„æ•°æ®åº“æ¥å¤„ç†ï¼Œå®ƒå¯ä»¥è·Ÿè¸ªæ‰€æœ‰çš„æèµ è€…:  ä»»ä½•é”™è¿‡äº†ç«é€‰æ´»åŠ¨æœ€åæœŸé™çš„äººéƒ½æ— æ³•è¿›å…¥ï¼Œä»»ä½•æ”¹å˜ä¸»æ„çš„æèµ è€…éƒ½æ— æ³•ç¦»å¼€ã€‚ ç›¸åï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯å»ä¸­å¿ƒåŒ–çš„æ–¹æ³•ç„¶ååˆ›å»ºä¸€ä¸ª [token](./token) æ¥è·Ÿè¸ªå›æŠ¥, ä»»ä½•æœ‰è´¡çŒ®çš„äººéƒ½ä¼šå¾—åˆ°ä¸€ä¸ªtokenï¼Œä»–ä»¬å¯ä»¥äº¤æ˜“ã€å‡ºå”®æˆ–ä¿å­˜ã€‚å½“ç»™äºˆç‰©è´¨å¥–åŠ±çš„æ—¶å€™ç”Ÿäº§è€…åªéœ€è¦äº¤æ¢çœŸäº§å“çš„ä»£å¸ã€‚ æèµ è€…å¯ä»¥ä¿ç•™ä»–ä»¬çš„æ ‡è®°ï¼Œå³ä½¿è¿™ä¸ªé¡¹ç›®æ²¡æœ‰è¾¾åˆ°ä»–ä»¬çš„ç›®çš„ï¼Œä½œä¸ºçºªå¿µå“ã€‚

æ­¤å¤–ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œé‚£äº›èµ„åŠ©çš„äººåœ¨èµ„é‡‘ç­¹é›†å’Œç®¡ç†ä¸å–„çš„æƒ…å†µä¸‹æ— æ³•å¯¹èµ„é‡‘çš„ä½¿ç”¨æƒ…å†µæœ‰ä»»ä½•å‘è¨€æƒï¼Œå¾€å¾€å¯¼è‡´é¡¹ç›®æ ¹æœ¬æ— æ³•æä¾›ä»»ä½•ä¸œè¥¿ã€‚ åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªæ°‘ä¸»ç»„ç»‡[Democratic Organization](./dao)ï¼Œå®ƒå°†å¿…é¡»æ‰¹å‡†ä»ç³»ç»Ÿä¸­è·å¾—çš„ä»»ä½•èµ„é‡‘ã€‚ è¿™é€šå¸¸è¢«ç§°ä¸ºä¼—ç­¹æˆ–ç¾¤ä½“æƒç›Šè¿™æ˜¯éå¸¸åŸºæœ¬çš„ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»¤ç‰Œå¯ä»¥æ˜¯å¥–åŠ±æœ¬èº«,This is often called a **crowdsale** or **crowd equity** and is so fundamental that in some cases the token can be the reward itself, ç‰¹åˆ«æ˜¯åœ¨ä¸€äº›é¡¹ç›®ä¸­ï¼Œä¸€ç¾¤äººèšåœ¨ä¸€èµ·ï¼Œå…±åŒå»ºè®¾å…¬å…±å…¬ç›Šäº‹ä¸šã€‚

![Get the necessary contracts](https://ethereum.org/images/tutorial/token-crowdsale.png)


* æœæ‚¨åªæ˜¯æµ‹è¯•ï¼Œå°†é’±åŒ…åˆ‡æ¢åˆ°testnetå¹¶å¼€å§‹æŒ–æ˜ã€‚

* é¦–å…ˆ, åˆ›å»ºä¸€ä¸ª [fixed supply token](./token#the-code).å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ª **100**ï¼Œ ä½¿ç”¨åå­— **gadgets**, the box emoji (ğŸ“¦) as a symbol and **0** decimal places. éƒ¨ç½²å¹¶ä¿æŒåœ°å€ã€‚

* ç°åœ¨åˆ›å»ºä¸€ä¸ª [shareholder association](./dao#the-shareholder-association). In this example we are going to use the address of the token we just created as the **Shares Address**, a minimum quorum of **10**, and **1500** minutes (25 hours) as the voting time. Deploy this contract and save the address.


#### The code

ç°åœ¨å¤åˆ¶è¿™æ®µä»£ç ï¼Œç„¶ååˆ›å»ºä¼—ç­¹:

```
!!!include(solidity/crowdsale.sol)!!!
```

#### Code highlights

æ³¨æ„ï¼Œ**Crowdsale**åŠŸèƒ½(the one that is called upon contract creation)ä¸­æ˜¯å¦‚ä½•è®¾ç½® **deadline** and **fundingGoal** çš„ã€‚

    fundingGoal = fundingGoalInEthers * 1 ether;
    deadline = now + durationInMinutes * 1 minutes;
    price = etherCostOfEachToken * 1 ether;

æœ‰ä¸€äº› [special keywords](https://solidity.readthedocs.io/en/latest/units-and-global-variables.html) åœ¨solidityä¸­å¸®åŠ©ä½ ç¼–ç ï¼Œin solidity that help you code, å…è®¸ä½ è¯„ä¼°ä¸€äº›lç±»ä¼¼ **1 ether == 1000 finney** æˆ–è€… **2 days == 48 hours**. åœ¨ç³»ç»Ÿå†…éƒ¨ï¼Œæ‰€æœ‰çš„etherå«é‡éƒ½è¢«å®šä¹‰ä¸º **wei**,æœ€å°å¯åˆ†çš„å•ä½ï¼Œæœ€å°å¯åˆ†çš„å•ä½ã€‚ The code above converts the funding goal into wei by multiplying it by 1,000,000,000,000,000,000 (which is what the special keyword **ether** converts into). The next line creates a timestamp that is exactly X minutes away from today by also using a combination of the special keywords **now** and **minutes**. For more global keywords, check the [solidity documentation on Globally available variables](https://solidity.readthedocs.io/en/latest/units-and-global-variables.html).

The following line will instantiate a contract at a given address:

    tokenReward = token(addressOfTokenUsedAsReward);

Notice that the contract understands what a *token* is because we defined it earlier by starting the code with:

    interface token { function transfer(address receiver, uint amount){  } }

This doesn't fully describe how the contract works or all the functions it has, but describes only the ones this contract needs: a token is a contract with a *transfer* function, and we have one at this address.


#### How to use

ç‚¹å‡» **contracts** ç„¶å **deploy contract**:

![Crowdsale deployment](https://ethereum.org/images/tutorial/crowdsale-deploy.png)

* è®¾ç½®ä½ åˆšåˆšåˆ›å»ºçš„ç»„ç»‡çš„åœ°å€ **if successful, send to**.

* è®¾ç½® **250** ethers ä¸ºèèµ„ç›®æ ‡

* å¦‚æœä½ åªæ˜¯ä¸ºäº†è¿›è¡Œæµ‹è¯•æˆ–æ¼”ç¤º,å°†ä¼—ç­¹çš„æŒç»­æ—¶é—´è®¾ç½®ä¸º3-10åˆ†é’Ÿï¼Œ ä½†æ˜¯å¦‚æœä½ çœŸçš„åœ¨ç­¹é›†èµ„é‡‘ä½ å¯ä»¥æŠ•å…¥æ›´å¤§çš„èµ„é‡‘, åˆ—å¦‚ **45,000** (31 days).

* The **ether cost of each token** åº”è¯¥æ ¹æ®ä½ å‡†å¤‡å‡ºå”®å¤šå°‘ä»£å¸æ¥è®¡ç®—. (åœ¨å‰é¢çš„æ­¥éª¤ä¸­ï¼Œæ‚¨æ·»åŠ çš„ä»¤ç‰Œçš„â€œåˆå§‹ä¾›åº”â€æ•°é‡çš„æœ€å¤§å€¼).åœ¨æœ¬ä¾‹ä¸­ï¼Œæ”¾å…¥5ä¸ª ether.

* æ‚¨åˆ›å»ºçš„ä»¤ç‰Œçš„åœ°å€åº”è¯¥æ·»åŠ åˆ° **token reward address**

è®¾ç½®ä¸€ä¸ªæ±½æ²¹ä»·æ ¼ï¼Œç‚¹å‡»éƒ¨ç½²ï¼Œç­‰å¾…ä½ çš„ä¼—ç­¹. ä¸€æ—¦åˆ›å»ºäº†ä¼—ç­¹é¡µé¢ï¼Œä½ ç°åœ¨å°±éœ€è¦å­˜è¶³å¤Ÿçš„é’±æ¥æ”¯ä»˜å›æŠ¥ã€‚ç‚¹å‡»ä¼—ç­¹çš„åœ°å€ï¼Œç„¶åè¿›è¡Œå­˜æ¬¾å’Œå‘é€ **50 gadgets** to the crowdsale.

**I have 100 gadgets. Why not sell them all?**

è¿™æ˜¯éå¸¸é‡è¦çš„ä¸€ç‚¹ã€‚æˆ‘ä»¬æ­£åœ¨æ„å»ºçš„ä¼—ç­¹å°†å®Œå…¨ç”±ä»¤ç‰ŒæŒæœ‰äººæ§åˆ¶ã€‚è¿™å°±é€ æˆäº†ä¸€ä¸ªå±é™©ï¼Œå³æ§åˆ¶æ‰€æœ‰æ ‡è®°çš„50%+1çš„äººå°†èƒ½å¤Ÿå°†æ‰€æœ‰çš„èµ„é‡‘å‘é€ç»™è‡ªå·±ã€‚ä½ å¯ä»¥å°è¯•åœ¨å…³è”åˆåŒä¸Šåˆ›å»ºç‰¹æ®Šçš„ä»£ç æ¥é˜²æ­¢è¿™äº›æ¶æ„çš„æ”¶è´­, æˆ–è€…ä½ å¯ä»¥æŠŠæ‰€æœ‰çš„èµ„é‡‘éƒ½å‘é€åˆ°ä¸€ä¸ªç®€å•çš„åœ°å€.ç®€å•åœ°è¯´ï¼Œæˆ‘ä»¬åªæ˜¯ç®€å•åœ°å–æ‰äº†ä¸€åŠçš„å°å·¥å…·: å¦‚æœæ‚¨æƒ³è¿›ä¸€æ­¥åˆ†æ•£å®ƒï¼Œåˆ™å°†å‰©ä¸‹çš„ä¸€åŠåˆ†é…ç»™å—ä¿¡ä»»çš„ç»„ç»‡ã€‚

#### ç­¹é›†èµ„é‡‘

ä¸€æ—¦ä¼—ç­¹å®Œæˆäº†æ‰€æœ‰å¿…è¦çš„token,å¯¹å®ƒçš„è´¡çŒ®å¾ˆç®€å•ï¼Œä½ å¯ä»¥ä»ä»»ä½•ä»¥å¤ªé’±åŒ…é‡Œå®Œæˆ:åªè¦æŠŠé’±å¯„ç»™å®ƒå°±è¡Œäº†ã€‚æ‚¨å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ç›¸å…³çš„ä»£ç :

    function () {
        require(!crowdsaleClosed);
        uint amount = msg.value;
        // ...

The [unnamed function](https://solidity.readthedocs.io/en/latest/contracts.html#fallback-function) is the default function executed whenever a contract receives ether. è¿™ä¸ªåŠŸèƒ½ä¼šè‡ªåŠ¨æ£€æŸ¥ä¼—ç­¹æ´»åŠ¨æ˜¯å¦æ´»è·ƒï¼Œ è®¡ç®—è°ƒç”¨è€…è´­ä¹°äº†å¤šå°‘ä¸ªä»¤ç‰Œï¼Œå¹¶å‘é€ç›¸åº”çš„ä»¤ç‰Œã€‚ å¦‚æœä¼—åŒ…å·²ç»ç»“æŸæˆ–è€…åˆåŒæ²¡æœ‰ç­¾è®¢åˆåŒï¼ŒåˆåŒå°±ä¼šç»ˆæ­¢ **throw** meaning the execution will be stopped and å‘é€çš„ä»¥å¤ªå°†è¢«è¿”å› (ä½†æ˜¯æ‰€æœ‰çš„æ°”ä½“éƒ½ä¼šè¢«èŠ±æ‰).

![Crowdsale error](https://ethereum.org/images/tutorial/crowdsale-error.png)

è¿™æ ·åšçš„å¥½å¤„æ˜¯åˆåŒå¯ä»¥é˜²æ­¢é™·å…¥è¿™æ ·ä¸€ç§æƒ…å†µå³æœ‰äººä¼šç¦»å¼€ä»–ä»¬çš„ä»¥å¤ªæˆ–ä»£å¸. åœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿä¼š[**self destruct**](https://solidity.readthedocs.io/en/latest/units-and-global-variables.html#contract-related) ä¼—ç­¹ç»“æŸåçš„åˆåŒ: è¿™æ„å‘³ç€åœ¨é‚£ä¸€åˆ»ä¹‹åçš„ä»»ä½•äº¤æ˜“éƒ½å°†å¤±å»ä»–ä»¬çš„èµ„é‡‘. é€šè¿‡åˆ›å»ºä¸€ä¸ªå›é€€åŠŸèƒ½,æŠŠé”€å”®ç»“æŸå,æˆ‘ä»¬é˜²æ­¢ä»»ä½•äººå¤±å»é’±ã€‚

The contract has a safeWithdrawl() function,æ²¡æœ‰ä»»ä½•å‚æ•°,å¯ä»¥æ‰§è¡Œç”±å—ç›Šäººçš„è®¿é—®æˆ–èµ„åŠ©è€…å›åˆ°ä»–ä»¬çš„åŸºé‡‘å‹Ÿæå¤±è´¥çš„æƒ…å†µã€‚

![Crowdsale execution](https://ethereum.org/images/tutorial/crowdsale-execute.png)

### Extending the crowdsale

#### å¦‚æœä¼—ç­¹è¶…è¿‡äº†ç›®æ ‡ï¼Œé‚£è¯¥æ€ä¹ˆåŠ?

åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œåªæœ‰ä¸¤ä»¶äº‹å¯ä»¥å‘ç”Ÿ:ä¼—ç­¹è¾¾åˆ°ç›®æ ‡ï¼Œæˆ–è€…æ²¡æœ‰å®ç°ã€‚ ç”±äºä»¤ç‰Œæ•°é‡æœ‰é™ï¼Œè¿™æ„å‘³ç€ä¸€æ—¦è¾¾åˆ°ç›®æ ‡ï¼Œå°±æ²¡æœ‰å…¶ä»–äººèƒ½å¤Ÿåšå‡ºè´¡çŒ®ã€‚ ä¸è¿‡ï¼Œä¼—ç­¹çš„å†å²ä¸Šå……æ–¥ç€è¶…å‡ºé¢„æœŸçš„é¡¹ç›®ï¼Œæ¯”é¢„æœŸçš„æ—¶é—´è¦çŸ­å¾—å¤šï¼Œæˆ–è€…æ¯”é¢„æœŸçš„è¦å¤šå‡ºå¾ˆå¤šå€ã€‚

#### Unlimited crowdsale

æ‰€ä»¥æˆ‘ä»¬è¦ç¨å¾®ä¿®æ”¹ä¸€ä¸‹æˆ‘ä»¬çš„é¡¹ç›®è€Œä¸æ˜¯å‘é€ä¸€ç»„æœ‰é™çš„ä»¤ç‰Œ
, å®é™…ä¸Šï¼Œæ¯å½“æœ‰äººç»™ä»–ä»¬å‘é€ä»¥å¤ªçš„æ—¶å€™ï¼Œè¿™ä¸ªé¡¹ç›®å°±ä¼šå‡­ç©ºåˆ›é€ å‡ºä¸€ä¸ªæ–°çš„ä»¤ç‰Œã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª [Mintable token](./token#central-mint).

ç„¶åä¿®æ”¹ä¼—åŒ…ä»¥é‡å‘½åæ‰€æœ‰æåˆ°çš„ **transfer** to **mintToken**:



    contract token { function mintToken(address receiver, uint amount){  } }
    // ...
        function () {
            // ...
            tokenReward.mintToken(msg.sender, amount / price);
            // ...
        }

ä¸€æ—¦ä½ å‘å¸ƒäº†ä¼—åŒ…é”€å”®åˆåŒï¼Œä½ å°±å¯ä»¥è·å¾—å®ƒçš„åœ°å€å¹¶è¿›å…¥ä½ çš„å…¬å¸ã€‚ **Token Contract** to execute a **Change Ownership** function. This will allow your crowdsale to call the **Mint Token** function as much as it wants.

**Warning:**  This opens you to the danger of hostile takeover. At any point during the crowdsale anyone who donates more than the amount already raised will be able to control the whole pie and steal it. There are many strategies to prevent that, but implementing will be left as an exercise to the reader:

* Modify the crowdsale such that when a token is bought, also send the same quantity of tokens to the founder's account so that they always control 50% of the project
* Modify the Organization to create a veto power to some trusted third party that could stop any hostile proposal
* Modify the token to allow a central trusted party to freeze token accounts, so as to require a verification that there isn't any single entity controlling a majority of them

